@model IEnumerable<VideoRentalSite.Models.video>
@using WebMatrix.Data;
@{
    ViewBag.Title = "Главная";
}
<div>
    @Html.ActionLink("List of video", "Index", "videos")<br />
    @Html.ActionLink("List of users", "Index", "users")
</div>

<div class="container">
    <div class="row">
        <div class="col-md-4">sidebar</div>
        <div class="col-md-8">

            <div>
                @foreach (var item in Model)
                {

                    <img href=@Html.DisplayFor(modelItem => item.video_cover_url) />
                    <div><h2>@Html.DisplayFor(modelItem => item.video_name)</h2></div>
                    <div><span>Описание:</span>@Html.DisplayFor(modelItem => item.video_description)</div>
                    <div><span>Страна</span>@Html.DisplayFor(modelItem => item.video_country)</div>
                    <div><span>Год выпуска</span>@Html.DisplayFor(modelItem => item.video_year)</div>
                    
                        string connectionString = @"VideoRentalDatabase";
                        string genreName = "";
                        using (var db = Database.Open(connectionString))
                        {

                            IEnumerable<dynamic> genre = db.Query("SELECT genre.genre_name FROM genre, videogenre WHERE " +
                                "videogenre.videogenre_id_genre = genre.genre_id and videogenre.videogenre_id_video = " + item.video_id);

                            foreach (var g in genre)
                            {
                                genreName += @g.genre_name + " ";
                            }
                        }
                    
                    <div><span>Жанр: </span>@genreName</div>
                    <div>@Html.ActionLink("Details", "Details", new { id = item.video_id }) </div>

                }
            </div>
        </div>
    </div>
</div>